<!DOCTYPE html>
<html lang="en">
  <head>
    <meta
      name="generator"
      content="HTML Tidy for HTML5 for Linux version 5.6.0"
    />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Voice Activity Detection for the Browser</title>
    <link rel="stylesheet" href="/style.css" />
    <link
      href="https://unpkg.com/prismjs@1.20.0/themes/prism-okaidia.css"
      rel="stylesheet"
    />
    <script defer src="/demo.js" type="module"></script>
    <script defer src="/_vercel/insights/script.js"></script>
    <script
      src="https://challenges.cloudflare.com/turnstile/v0/api.js?render=explicit"
      defer
    ></script>
  </head>
  <body class="no-scrollbar min-h-screen flex flex-col justify-between">
    <div>
      <div class="md:w-[768px] md:mx-auto">
        <nav class="flex flex-col sm:flex-row pt-8 pb-5 px-5">
          <div class="mr-4">
            <a href="/">home</a>
          </div>
          <div class="mr-4">
            <a target="_blank" href="https://docs.vad.ricky0123.com/">docs</a>
          </div>
          <div class="mr-4">
            <a target="_blank" href="http://github.com/ricky0123/vad">github</a>
          </div>
          <div class="mr-4">
            <a target="_blank" href="https://discord.gg/4WPeGEaSpF">discord</a>
          </div>
          <div class="">
            <a target="_blank" href="https://github.com/sponsors/ricky0123"
              >sponsor me</a
            >
          </div>
        </nav>
      </div>
      <div class="prose px-5 max-w-none md:w-[768px] md:mx-auto">
        <h1>
          An accurate, user-friendly voice activity detector for the browser
        </h1>
        <p class="text-xl mt-2">
          Prompt your user for microphone permissions and run callbacks on
          segments of audio with user speech in a few lines of code.
        </p>
        <p>
          See the
          <a target="_blank" href="https://docs.vad.ricky0123.com">docs</a> to
          get started with using the voice activity detector in
          <span>browser</span>, <span>node</span>, or
          <span>react</span> projects.
        </p>
        <p>Or, see it in action in the demo below!</p>
        <div id="demo"></div>
      </div>
    </div>
    <div>
      <footer
        class="mt-2 px-5 mb-2 md:w-[768px] md:mx-auto flex flex-col sm:flex-row justify-between items-center sm:items-end"
      >
        <div
          class="flex flex-col items-center sm:flex-row sm:border-2 sm:rounded sm:border-lime-400/50"
        >
          <div class="ml-1 mb-1 sm:mb-0">Receive updates:</div>
          <form
            class="ml-2 border-solid border-2 border-lime-400/50 sm:border-0 rounded"
            onsubmit="submitEmail(event)"
          >
            <input
              type="email"
              name="email"
              placeholder="you@example.com..."
              class="placeholder:underline placeholder:italic max-w-[150px] px-1"
              required
              autocomplete="email"
            />
            <button type="submit" class="ml-2 bg-lime-400/50 px-1">
              <span class="inline-flex items-center">
                <span>Send</span>
                <svg
                  class="w-4 h-4 ml-1"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    d="M5 12h14M12 5l7 7-7 7"
                  />
                </svg>
              </span>
            </button>
          </form>
        </div>
        <div class="mt-1 sm:mt-0">&copy; 2025 Ricky Samore</div>
      </footer>
      <dialog id="submitEmailDialog" class="rounded" style="outline: none">
        <div id="submitEmailDialogStatus"></div>
        <div id="turnstile-widget"></div>
      </dialog>
    </div>
    <script>
      window.submitEmail = async (event) => {
        event.preventDefault();
        try {
          const submitEmailDialog =
            document.getElementById("submitEmailDialog");
          const status = document.getElementById("submitEmailDialogStatus");

          status.textContent = "";
          submitEmailDialog.showModal();
          const { token, widgetId } = await getTurnstileToken();

          const source = window.location.hostname;
          const name = "";
          const email = event.target.elements.email.value;

          const response = await fetch(
            "https://api.ricky0123.com/api/new-sign-up",
            {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ email, token, source, name }),
            }
          );
          const result = await response.json();

          if (result.success) {
            status.textContent = "Thanks! You're subscribed.";
          } else {
            status.textContent = "Something went wrong. Try again?";
          }
          // event.target.reset();
          // turnstile.reset();
          turnstile.remove(widgetId);
        } catch (e) {
          console.log(e);
          status.textContent = "Sorry, there was an error.";
        }
      };

      const getTurnstileToken = () => {
        return new Promise((res, rej) => {
          const widgetId = turnstile.render("#turnstile-widget", {
            sitekey: actualSiteKey, // alwaysPassSiteKey,
            size: window.innerWidth <= 768 ? "compact" : "normal",
            callback: function (token) {
              res({ token, widgetId });
            },
            "error-callback": function (errorCode) {
              rej({ errorCode, widgetId });
            },
          });
        });
      };

      const alwaysPassSiteKey = "1x00000000000000000000AA";
      const actualSiteKey = "0x4AAAAAACGTVUPmIFsJov8d";
    </script>
  </body>
</html>
